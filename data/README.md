# 实例生成器使用说明

基于 Solomon VRPTW 基准数据集生成无人机周期性监控问题的测试实例。

## 功能概述

本工具从 Solomon 数据集中提取节点坐标信息，计算节点间的欧几里得距离，为每个监控目标随机分配监控周期，并生成标准格式的实例文件供求解器使用。

主要功能：
- 从 Solomon 数据集提取节点坐标
- 计算节点间距离并转换为时间单位
- 随机分配监控周期（可配置）
- 自动生成标准格式实例文件

## 环境要求

- Python 3.x
- 依赖包：`pandas`, `numpy`, `math`, `os`（后两者为标准库）

## 数据准备

Solomon 基准数据文件需放置在正确的目录结构中：

```
data/
├── generate_period.py      # 生成脚本
├── solomon/                # Solomon 数据集目录
│   ├── c101.txt           # C1 类型数据
│   ├── c201.txt           # C2 类型数据
│   ├── r102.txt           # R1 类型数据
│   └── rc101.txt          # RC1 类型数据
└── input/                  # 输出目录（自动创建）
    ├── C1/
    ├── C2/
    ├── R1/
    └── RC1/
```

**Solomon 数据集获取**：
- 官方网站：https://www.sintef.no/projectweb/top/vrptw/solomon-benchmark/
- 或搜索 "Solomon VRPTW benchmark dataset"

## 快速开始

### 步骤 1：修改生成参数

打开 `generate_period.py`，找到主程序部分（约第389行），修改以下参数：

```python
# ========== 生成参数配置 ==========
period_list = [3, 6, 12, 18, 24]  # 可选的监控周期
    
# 批量生成配置
target_num = 35      # 目标点数量（修改此处）
drone_num = 100      # 无人机数量（修改此处）
time_num = 18        # 规划时间范围（修改此处）
version_range = range(30, 35)  # 生成版本 30p 到 34p（修改此处）
```

### 步骤 2：运行脚本

在命令行中执行：

```bash
cd data
python generate_period.py
```

运行输出示例：
```
============================================================
无人机持续监控实例生成器
============================================================
配置参数:
  - 目标点数量: 35
  - 无人机数量: 100
  - 时间范围: 18
  - 监控周期选项: [3, 6, 12, 18, 24]
  - 输出目录: D:\...\data\input
============================================================

正在生成实例类型: C1
------------------------------------------------------------
✓ 已生成实例: C1N35D100T18V30p
✓ 已生成实例: C1N35D100T18V31p
...
```

### 步骤 3：查看输出文件

生成的实例文件位于：`data/input/{实例类型}/`

例如：`data/input/C1/C1N35D100T18V30p.txt`

## 参数配置说明

### 主要参数（在主程序中配置）

| 参数 | 说明 | 示例值 | 建议范围 | 备注 |
|------|------|--------|----------|------|
| `target_num` | 目标点数量（不含起点） | 25, 35 | 10-50 | 过大会导致求解困难 |
| `drone_num` | 可用无人机数量 | 100 | 20-200 | 根据问题规模设置 |
| `time_num` | 规划时间范围 | 12, 18, 24 | 6-24 | 需要能容纳所有周期 |
| `period_list` | 可选监控周期列表 | [3,6,12,18,24] | 按需 | 不超过 time_num |
| `version_range` | 生成版本数 | range(0,5) | 按需 | 用于生成多个随机实例 |

### 实例类型配置（一般无需修改）

| 实例类型 | Solomon文件 | 无人机续航（原始） | 规划窗口（原始） | 特点 |
|---------|------------|------------------|-----------------|------|
| C1   | c101.txt   | 90 | 108 | 聚类分布、短时间窗 |
| C2   | c201.txt   | 90 | 108 | 聚类分布、长时间窗 |
| R1   | r102.txt   | 90 | 108 | 随机分布、短时间窗 |
| RC1  | rc101.txt  | 110 | 132 | 混合分布、短时间窗 |

说明：表中的"原始"时间值会根据 `time_num` 自动缩放到新的时间单位。

### 时间缩放机制

原始 Solomon 数据集的时间单位较大（如108），脚本会自动缩放到您指定的 `time_num`：

```
缩放因子 = time_num / planning_horizon
例如：time_num=18, planning_horizon=108 → 缩放因子 ≈ 0.167

无人机续航：90 × 0.167 ≈ 15
规划窗口：108 × 0.167 = 18
节点间距离也会按此比例缩放
```

## 输出文件说明

### 文件命名规则

格式：`{类型}N{目标数}D{无人机数}T{时间}V{版本}.txt`

命名示例：
- `C1N25D100T18V0p.txt` → C1类型，25个目标，100架无人机，18时间单位，版本0p
- `R1N10D20T12V3p.txt` → R1类型，10个目标，20架无人机，12时间单位，版本3p
- `RC1N35D50T24V15p.txt` → RC1类型，35个目标，50架无人机，24时间单位，版本15p

### 目录结构

```
input/
├── C1/
│   ├── C1N25D100T18V0p.txt
│   ├── C1N25D100T18V1p.txt
│   └── ...
├── C2/
│   ├── C2N25D100T18V0p.txt
│   └── ...
├── R1/
│   └── ...
└── RC1/
    └── ...
```

### 文件内容结构

```
第1行: 列标题
numNode	numCus	ID_Depot	Mile(min)	Begin	End	numUAV

第2行: 基本参数
36	35	0	15	0	18	100
[节点总数] [目标数] [仓库ID] [续航] [开始时间] [结束时间] [无人机数]

第3行: 数据标题
time_vec & deta1 & deta2:

第4+行: 节点数据（每行一个节点）
0	555556	2	3	...	0	100000
[节点ID] [到节点0的时间] [到节点1的时间] ... [开始监控时间] [监控周期]
```

**字段说明**：
- 节点0为起点/仓库，监控周期为100000（表示不需要监控）
- 其他节点为监控目标，周期从 `period_list` 中随机选择
- 555556 表示无限大距离（节点到自身）
- 节点间的时间值为飞行时间（从距离转换而来）

## 使用示例

### 示例 1：生成小规模测试实例

适合快速测试求解器：

```python
# 修改主程序参数
target_num = 10          # 10个目标点
drone_num = 20           # 20架无人机
time_num = 12            # 12个时间单位
period_list = [3, 6, 12]
version_range = range(0, 3)  # 生成3个版本
```

运行后生成：C1/C2/R1/RC1 各3个实例，共12个文件

### 示例 2：生成大规模实验实例

适合论文实验：

```python
target_num = 50          # 50个目标点
drone_num = 150          # 150架无人机
time_num = 24            # 24个时间单位
period_list = [3, 6, 12, 18, 24]
version_range = range(0, 10)  # 生成10个版本
```

运行后生成：C1/C2/R1/RC1 各10个实例，共40个文件

### 示例 3：只生成特定类型实例

如果只需要某几种类型：

在主程序循环中添加过滤（约第410行）：

```python
for key, val in instance_dict.items():
    # 只生成 C1 和 C2 类型
    if key not in ('C1', 'C2'):
        continue
    
    print(f"\n正在生成实例类型: {key}")
    # ... 后续代码
```
